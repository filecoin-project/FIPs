---
fip: "0066"
title: Extension of Runtime Methods for Address Verification
author: "David Casem <@dcasem>"
discussions-to: https://github.com/filecoin-project/FIPs/discussions/401
status: Draft
type: Technical
category: Core
created: 2023-07-24
---

## Simple Summary
Introduces a method to the built-in Miner actor for address validation to be used in determining \
whether a given address corresponds to the worker of the queried Miner on the Filecoin network.

## Abstract
The proposed FIP introduces a new method to the built-in miner actor for address validation to be used in determining \
whether a given address corresponds to the worker of the queried Miner on the Filecoin network.

## Change Motivation
There are several scenarios in the Filecoin protocol where it is necessary to confirm if a particular address belongs to a miner actor as a worker key. Having a dedicated exported method in the miner actorto handle such checks can increase efficiency and readability of the codebase.

## Specification
We propose to introduce a new method: `is_worker_address()` to the Miner actor. This function receives an address as parameter and returns a boolean indicating whether this address corresponds to a worker in the network or not. The function implements a logic to resolve the address and checks it against the current worker address.

Pseudocode

The pseudocode below demonstrates the intended implementation of the `is_worker_address()` function:
```function is_worker_address(rt: Runtime, params: IsWorkerAddressParams) returns Result<IsWorkerAddressReturn, ActorError>:

    // Accept any caller
    rt.validate_immediate_caller_accept_any()

    // Resolve the address
    address = rt.resolve_address(params.address)

    // If address is null, return false
    if address is null:
        return Ok(IsWorkerAddressReturn { is_worker: false })

    // Fetch the current state
    state = rt.state()

    // Retrieve the miner info
    info = get_miner_info(rt.store(), state)

    // Check if the resolved address matches the worker address
    is_worker = (address == info.worker)

    // Return the result
    return Ok(IsWorkerReturn { is_worker })
```

## Backwards Compatibility
This proposal should not have any backward compatibility issues. The function is a new addition and does not alter any existing methods or structures.

## Test Cases
To ensure the correctness of the `is_worker_address()` function, multiple test cases covering different scenarios (worker/non-worker addresses, non-resolvable addresses etc.) should be considered.


Possible Tests:

`IsWorkerAddress` correctly identifies the worker address

`IsWorkerAddress` correctly identifies non-worker addresses

## Implementation
This FIP does not require any changes to existing protocols. The changes would be implemented in the actor package in the. The exact implementation details will depend on the codebase at the time of implementation.


## Security Considerations
The proposed function does not introduce any new security considerations as it only checks existing data structures. It is important to ensure that the function is implemented correctly to avoid any potential security issues.

## Implementation
This FIP does not require any changes to existing protocols. The changes would be implemented in the `actor` package. The exact implementation details will depend on the codebase at the time of implementation.

## Copyright
Copyright and related rights waived via [CC0](https://creativecommons.org/publicdomain/zero/1.0/).
